    template<typename T>
    inline T sqr(const T& val) {
      return val*val;