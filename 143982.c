    template<typename T>
    inline T abs(const T& a) {
      return a>=0?a:-a;