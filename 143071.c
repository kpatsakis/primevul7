    }
    inline int mod(const short x, const short m) {
      return x>=0?x%m:(x%m?m + x%m:0);